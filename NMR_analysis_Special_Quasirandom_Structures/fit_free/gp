#!/usr/bin/gnuplot -persist
#set term postscript color eps enhanced blacktext 'Helvetica,24'
#set out 'internal_energy.eps'
set ylabel "Free energy difference (with respect quartz) / eV" 
set xlabel "Ge molar fraction / a.u."
set y2label 'Rendimiento / %'
set size ratio 1
set key bottom right
set xrange [0:1]
set y2range [0:50]
set y2tics
e_quartz_si=-10432.72150366
e_quartz_ge=-9866.77608526
temperature1=450
b=0.3
d=0.3
a=-1
c=1
e=1e-10
f=0.3
g=1e-10
h=0.3
i=1
j=0.3
set yrange [-20:-40]
f(x)=a*(x-b)**2+c*(x-d)**3+e*(x-f)**4+g*(x-h)**5+i*(j-x)**6
g(x)=a1*(x-b1)**2+c1*(x-d1)**3+e1*(x-f1)**4+g1*(x-h1)**5+i1*(j1-x)**6
s(value, left, right) = (value < left || value > right ? 1/0 : value)
fit [0:0.4]  f(x) 'c.fit' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) via a,c
fit [0:0.4]  f(x) 'c.fit' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) via a,b,c,d
fit [0:0.4]  f(x) 'c.fit' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) via e,f,g,h
fit [0:0.4]  f(x) 'c.fit' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) via b,d,f,h
fit [0:0.4]  f(x) 'c.fit' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) via a,b,c,d,e,f,g,h,i,j
# (f($1, 3, 7))
plot   'c' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) w p pt 6 ps 2 lc rgb 'red' title '450 K'
a1=a
b1=b
c1=c
d1=d
e1=e
f1=f
g1=g
h1=h
i1=i
j1=j
replot 'exp_Camblor_Reus/rendimiento.txt' w lp pt 6 ps 2 lc rgb 'black' title 'EXP',s(f(x),0.0,0.3) w l lc rgb 'blue' notitle
fit [0.3:]  g(x) 'c.fit' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) via a1,c1
fit [0.3:]  g(x) 'c.fit' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) via a1,b1,c1,d1
fit [0.3:]  g(x) 'c.fit' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) via e1,f1,g1,h1
fit [0.3:]  g(x) 'c.fit' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) via b1,d1,f1,h1
fit [0.3:]  g(x) 'c.fit' u ($1/60):($2-(60-$1)*(e_quartz_si/81.0)-$1*(e_quartz_ge/81.0)-$3*temperature1-$6) via a1,b1,c1,d1,e1,f1,g1,h1,i1,j1
replot s(g(x),0.3,1) w l lc rgb 'blue' notitle
set term postscript color eps enhanced blacktext 'Helvetica,24'
set out 'internal_energy_new.eps'
replot
exit 
#    EOF
